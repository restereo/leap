(function(){var t=[].slice,n={}.hasOwnProperty,r=function(t,r){function e(){this.constructor=t}for(var u in r)n.call(r,u)&&(t[u]=r[u]);return e.prototype=r.prototype,t.prototype=new e,t.__super__=r.prototype,t};!function(t,n){return("undefined"!=typeof module&&null!==module?module.exports:void 0)?"undefined"!=typeof module&&null!==module?module.exports=n():void 0:("undefined"!=typeof define&&null!==define?define.amd:void 0)?define(t,n):this[t]=n()}("leap",function(){var n,e,u,o,i,c;return o=("undefined"!=typeof process&&null!==process?process.nextTick:void 0)||function(t){return setTimeout(t,1)},n=function(){function n(){var n,r=this;n=1<=arguments.length?t.call(arguments,0):[],this.current=this.root=new u(this._wrap_first(n)),this.then.flow=this,this.and.flow=this,this.manual_start||o(function(){return r.yeah()})}return n.prototype.then=function(){var n;return n=1<=arguments.length?t.call(arguments,0):[],this.current=this.current.child(n),this},n.prototype.and=function(t){return this.current===this.root&&(t=this._wrap_first(t)),this.current.sibling(t),this},n.prototype.rescue=function(t){return this._rescue=t,this},n.prototype._rescue=function(t){return console.log("leap failed"),console.log(t)},n.prototype.yeah=function(){return this.root.run(null,this._rescue)},n.prototype._wrap_first=function(t){var n,r,e,u,o;if(Array.isArray(t)){for(e=[],n=function(t){return e.push(function(n,r){return t.call(r,r)})},u=0,o=t.length;o>u;u++)r=t[u],n(r);return e}return function(n,r){return t.call(r,r)}},n}(),u=function(){function t(t){this._next=this._err=null,Array.isArray(t)?this.functions=t:"function"==typeof t&&(this.functions=[t])}return t.prototype.functions=[],t.prototype.child=function(n){return this._next=new t(n)},t.prototype.sibling=function(t){return this.functions.push(t)},t.prototype.run=function(t,n){var r,e,u,o,i,c,f,s,l,p,h=this;for(o=this.functions.length,c=[],r=0,i=function(e,u){var i;return i=function(t,u){return h.err?void 0:t?(h.err=t,n(t)):(1===o?c=u:c[e]=u,h._next&&++r===o?h._next.run(c,n):void 0)},i.next=i.cb=function(){var t;return t=Array.prototype.slice.call(arguments),t.unshift(null),i.apply(this,t)},"undefined"!=typeof Backbone&&(i.bb={success:function(){var t;return t=Array.prototype.slice.call(arguments),t.unshift(null),i.call(this,t)},error:function(){return i.call(this,Array.prototype.slice.call(arguments))}}),u.apply(i,[t,i])},l=this.functions,p=[],u=f=0,s=l.length;s>f;u=++f)e=l[u],p.push(i(u,e));return p},t}(),i=function(){var r;return r=1<=arguments.length?t.call(arguments,0):[],function(t,n,r){r.prototype=t.prototype;var e=new r,u=t.apply(e,n);return Object(u)===u?u:e}(n,r,function(){})},e=function(t){function n(){return c=n.__super__.constructor.apply(this,arguments)}return r(n,t),n.prototype.manual_start=!0,n}(n),i["export"]=function(){var n;return n=1<=arguments.length?t.call(arguments,0):[],function(t,n,r){r.prototype=t.prototype;var e=new r,u=t.apply(e,n);return Object(u)===u?u:e}(e,n,function(){})},i.map=function(t,r,e){var u,o,i,c,f;for(u=new n,i=function(t){return u.and(function(){return r.call(this,t,this)})},c=0,f=t.length;f>c;c++)o=t[c],i(o);return 1===t.length&&u.then(function(t){return this.next([t])}),e&&(u.then(function(t){return e(null,t)}),u.rescue(e)),u},n.prototype.then.map=function(t){return this.flow.then(function(n,r){return i.map(n,t,r)})},n.prototype.and.map=function(t){return this.flow.and(function(n,r){return i.map(n,t,r)})},i.reduce=function(t,r,e){var u,o,i,c,f;for(u=new n(function(){return this()}),i=function(t){return u.then(function(n){return r.call(this,t,n,this)})},c=0,f=t.length;f>c;c++)o=t[c],i(o);return e&&(u.then(function(t){return e(null,t)}),u.rescue(e)),u},n.prototype.then.reduce=function(t){return this.flow.then(function(n,r){return i.reduce(n,t,r)})},n.prototype.and.reduce=function(t){return this.flow.and(function(n,r){return i.reduce(n,t,r)})},i.filter=function(t,n,r){return i.map(t,n).then(function(n){var e,u,o,i,c;for(u=[],e=i=0,c=n.length;c>i;e=++i)o=n[e],o&&u.push(t[e]);return r?r(null,u):this.next(u)})},n.prototype.then.filter=function(t){return this.flow.then(function(n,r){return i.filter(n,t,r)})},n.prototype.and.filter=function(t){return this.flow.and(function(n,r){return i.filter(n,t,r)})},i.reject=function(t,n,r){return i.map(t,n).then(function(n){var e,u,o,i,c;for(u=[],e=i=0,c=n.length;c>i;e=++i)o=n[e],o||u.push(t[e]);return r?r(null,u):this.next(u)})},n.prototype.then.reject=function(t){return this.flow.then(function(n,r){return i.reject(n,t,r)})},n.prototype.and.reject=function(t){return this.flow.and(function(n,r){return i.reject(n,t,r)})},i.of={faith:i},i.VERSION="0.1.0",i})}).call(this);